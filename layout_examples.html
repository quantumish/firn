<html><head><meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,400;0,500;1,400&amp;display=swap" rel="stylesheet" /><link href="https://firn.theiceshelf.com/static/css/prism.css" rel="stylesheet" /><link href="https://firn.theiceshelf.com/static/css/firn_base.css" rel="stylesheet" /><link href="https://firn.theiceshelf.com/static/css/basscss.css" rel="stylesheet" /><link href="https://firn.theiceshelf.com/static/css/customization.css" rel="stylesheet" /><link href="https://firn.theiceshelf.com/static/img/favico.png" rel="icon" type="image/png" /><title>Firn - The Ice Shelf</title><script src="https://firn.theiceshelf.com/static/js/prism.js"></script></head><body><nav class="nav"><div class="nav-container"><div class="nav-left"><div id="nav-icon" onClick="toggleMenu()"><span></span><span></span><span></span><span></span></div><img class="nav-logo" src="https://firn.theiceshelf.com/static/img/ico-light.png" width="32" /></div><div class="nav-links"><a class="nav-links-item" href="https://firn.theiceshelf.com/"><span>Home</span></a><a class="nav-links-item" href="https://firn.theiceshelf.com/getting-started"><span>Docs</span></a><a class="nav-links-item" href="https://github.com/theiceshelf/firn"><span>Github</span></a></div></div></nav><main class="def-wrapper"><aside class="def-sidebar unfocused" id="sidebar"><ul class="firn-sitemap firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/index">Home</a></li><li class="firn-sitemap-item--child"><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/getting-started">Getting Started</a><ul class="firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/tutorial">Step by Step Tutorial</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/setup">Firn Setup (with Emacs)</a></li></ul></li><li class="firn-sitemap-item--child"><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/content">Content</a><ul class="firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/front-matter">Front Matter</a></li><li class="firn-sitemap-item--child"><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/layout">Layouts and Partials</a><ul class="firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/layout_examples">Layout/Partial Examples</a></li></ul></li><li class="firn-sitemap-item--child"><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/the-render-function">The Render Function</a><ul class="firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/files-and-headlines">Files And Headlines</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/folding">Folding</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/sitemap">Sitemap</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/adjacent-files">Adjacent Files</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/backlinks_and_related_files">Backlinks and Related Files</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/org_tags">Org Tags</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/firn_tags">Firn Tags</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/table-of-contents">Table Of Contents</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/logbooks">Logbooks</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/breadcrumbs">Breadcrumbs</a></li></ul></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/pages">Custom Pages</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/styling">Styling</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/data-and-metadata">Data and Metadata</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/static-assets">Static Assets / Attachments</a></li></ul></li><li class="firn-sitemap-item--child"><div class="firn-sitemap-item--no-link">Reference</div><ul class="firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/configuration">Configuration</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/limitations">Limitations</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/sample-page">Sample Page</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/changelog">Changelog</a></li><li><a class="firn-sitemap-item--link" href="https://firn.theiceshelf.com/repl">Repl</a></li></ul></li></ul></aside><article class="def-content-wrap"><div class="def-content"><h1 class="mb0">Layout/Partial Examples</h1><div class="flex h6 mb1"><div class="pr1">Last updated: </div><div class="italic">2021-01-12 16:23</div></div><div><section><p><span>Find below a series of examples of how you might setup your layouts or partials
to achieve specific effect.</span></p></section><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="blog-entries-and-list-of-updates"><span class="firn-headline-text"><span>Blog entries and list of updates</span></span></h1><section><p><span>Here are two snippets that, combined, create blog posts and an ordered
list of entries on the blog.  It is possible to create multiple
different themed “blogs” as part of a given site, by creating multiple
modified versions of this template.</span></p><p><span>This layout formats the list of blog entries:</span></p><pre class="language-clojure"><code class="language-clojure">(defn blog
  [{:keys [build-url title render partials]}]
  (let [{:keys [head]} partials]
    [:html
     (head build-url)
     [:body
      [:main
       [:article.def-wrapper
        [:div.def-content
         [:h1 title]
         ;; List files that are "FIRN_UNDER" the "Updates" page
         (render :sitemap {:start-at ["Updates"]
                           :depth 1
                           :sort-by :newest})
         [:hr]
         [:div.back-to-main
          [:p "Back to main index: "
           [:a {:href "./index"} "Index"]]]
         ]]]]]))
</code></pre><p><span>The layout should be accompanied by an Org mode file like the
following:</span></p><pre class="language-org"><code class="language-org">#+title: Updates
#+FIRN_LAYOUT: blog

(Text written here will be overwritten when the page is rendered.)
</code></pre><p><span>The following layout formats an individual blog entry that will be
added to the list described above.</span></p><pre class="language-clojure"><code class="language-clojure">(defn blog-update
  [{:keys [render partials title meta date-created build-url]}]
  (let [{:keys [head]} partials]
    [:html
     (head build-url)
     [:body
      [:main
       [:article.content
        [:h1 title]
        [:i (str date-created " — " (-> meta :keywords :author))]
        [:div (render :file)]
        (when-let [backlinks (render :backlinks)] 
          [:div
           [:hr]
           [:div.backlinks
            [:h4 "Backlinks to this document:"]
            backlinks]])
        [:hr]
        [:div.back [:p "Back to blog: " [:a {:href "./updates"} "Updates"]]]]]]]))
</code></pre><p><span>Individual blog updates should contain header information as follows:</span></p><pre class="language-org"><code class="language-org">#+title: Your descriptive text here
#+FIRN_UNDER: Updates
#+FIRN_LAYOUT: update
#+DATE_CREATED: <2021-01-06 Wed>
#+DATE_UPDATED: <2021-01-16 Sat>
#+AUTHOR: Your name here
</code></pre><p><span>(The </span><code>DATE_UPDATED</code><span> field is optional relative to these layouts; see
below for one way in which it can be used.  Also, notice the date
format is </span><em><span>year</span></em><span>, </span><em><span>month</span></em><span>, </span><em><span>day</span></em><span>.)</span></p></section></div><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="recently-updated--published"><span class="firn-headline-text"><span>Recently Updated / Published</span></span></h1><section><p><span>This snippet demonstrates how to display a list of most recent recently published or updated org-files.</span></p><pre class="language-clojure"><code class="language-clojure">
(defn processed-files
  "Provides access to the list of processed files in the 'map of the world' that
  gets passed to each layout."
  [data]
  (-> data :config :processed-files vals))

(defn mru
  "`mru` stands for most-recently-updated, but this function also can provide most recently published.
  this function requires that your files have a #+DATE_UPDATED and #+DATE_CREATED
  front matter."
  ;; `data` - map - the entire configuration map passed to all layouts must be passed here.
  ;; `num-to-show` - integer to determine how many recent files should be shown
  ;; `recently` - a keyword that can be `:updated` or `:published`.
  [data {:keys [num-to-show recently]
         :or   {recently :updated}}]
  ;; we determine the keyword to use so that we may sort our files.
  (let [date-type (case recently
                    :updated :date-updated-ts
                    :created :date-created-ts)
        ;; we use the helper fn defined above to get access too all files.
        files     (processed-files data)
        ;; now we use clojure's sorting mechanism to sort by the determined
        ;; date-updated/created ts (timestamp -- which is internally available
        ;; to firn.)
        by-date   (sort-by (fn [a]
                             ; get-in's nill fallback doesn't seem to work so I'm using `or`.
                             (or (get-in a [:meta date-type]) 0)) >  files)
        ]

    ;; Here is the hiccup/html that is renderering a list of links to the fecent files
    [:ul.list-style-none.p0
     (for [f    (take num-to-show by-date)
           :let [{:keys [title date-updated-ts date-created-ts]}(f :meta)]]
       (when (and title date-updated-ts date-created-ts)
         [:li.px2 [:a {:href (f :path-web)} title]]))]))
</code></pre><p><span>Example usage:</span></p><pre class="language-clojure"><code class="language-clojure">(mru data {:num-to-show 5 :recently :updated})
</code></pre></section></div></div><div class="adjacent-files"><span><div class="firn-file-navigation"> </div></span></div><footer><script src="/static/js/main.js"></script></footer></div></article><aside class="def-toc unfocused" id="toc"><div><h4>Contents</h4><div><ol><li><a href="#blog-entries-and-list-of-updates">Blog entries and list of updates</a></li><li><a href="#recently-updated--published">Recently Updated / Published</a></li></ol></div></div></aside></main></body></html>